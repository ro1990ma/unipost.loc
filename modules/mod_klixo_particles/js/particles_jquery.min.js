/*mod_klixo_particles  - Version 1.5.2 - Copyright (C) 2012-2014 Klixo. All Rights Reserved. - @license http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL*/
(function(a){a.particleSystem=function(b){this.options=b;this.spriteArray=new Array();this.variance=new Array();this.init=function(){if(this.options.playMode==="screen"){this.getWinsize()}else{this.getContainersize(this.options.playMode)}this.createSprites()};this.createSprites=function(){for(var f=0;f<this.options.spritesNum;++f){var e=Math.random()*this.playArea.width;var d=Math.random()*this.playArea.height;var c=this.options.hTurbulence;this.hSpeed=this.options.hSpeed;this.vSpeed=this.options.vSpeed;this.variance[f]=Math.random()*c+c/2;this.spriteArray[f]=a("<div>",{id:"sprite_"+f}).css({position:"absolute",visibility:"visible","z-index":1000+f,top:d,left:e}).html('<img src="'+this.options.content+'"/>').prependTo(a(this.container))}};this.getWinsize=function(){this.playArea={width:a(window).width()-this.options.spriteWidth,height:a(window).height()-this.options.spriteHeight};this.container=a(document.body)};this.getContainersize=function(f){this.container=a("#"+this.options.moduleID);var e;if(f==="module"){e=this.container}if(f==="position"){var c=this.container.parent();var d=c.attr("class");if(d!==null&&d.indexOf("moduletable")!==-1){e=c.parent()}else{e=c}e.css({position:"relative"});this.container.css({width:e.width(),height:e.height(),top:0,left:0,position:"absolute"})}this.playArea={width:e.width()-this.options.spriteWidth,height:e.height()-this.options.spriteHeight}};this.animSprites=function(){for(var f=0;f<this.options.spritesNum;++f){var e=this.spriteArray[f].position();var d=e.left;var c=e.top;var h;var g;if(Math.abs(this.vSpeed)>Math.abs(this.hSpeed)){h=this.variance[f]>0?d+Math.sin(c/this.variance[f])+this.hSpeed:d+this.hSpeed;g=c+this.vSpeed}else{h=d+this.hSpeed;g=this.variance[f]>0?c+Math.cos(d/this.variance[f])+this.vSpeed:c+this.vSpeed}if(h<=0||h>=this.playArea.width-10||g<=0||g>=this.playArea.height-10){if(this.vSpeed===0){g=Math.random()*this.playArea.height;h=this.hSpeed>0?0:this.playArea.width-15}else{if(this.vSpeed>0){g=0;h=Math.random()*this.playArea.width}else{g=this.playArea.height-50;h=Math.random()*this.playArea.width}}}this.spriteArray[f].css({top:g,left:h})}};this.resetAnim=function(){for(var c=0;c<this.options.spritesNum;++c){this.spriteArray[c].remove()}this.getWinsize();this.createSprites()}}})(jQuery);
