/*mod_klixo_particles  - Version 1.5.2 - Copyright (C) 2012-2014 Klixo. All Rights Reserved. - @license http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL*/
var particleSystem=new Class({initialize:function(a){this.options=a;this.spriteArray=new Array();this.variance=new Array();if(this.options.playMode==="screen"){this.getWinsize()}else{this.getContainersize(this.options.playMode)}this.createSprites()},createSprites:function(){for(i=0;i<this.options.spritesNum;++i){var c=Math.random()*this.playArea.width;var b=Math.random()*this.playArea.height;var a=this.options.hTurbulence;this.hSpeed=this.options.hSpeed;this.vSpeed=this.options.vSpeed;this.variance[i]=Math.random()*a+a/2;this.spriteArray[i]=new Element("div",{html:'<img src="'+this.options.content+'"/>',id:"sprite_"+i,styles:{position:"absolute",visibility:"visible","z-index":1000+i,top:b,left:c}}).inject($(this.container),"top")}},getWinsize:function(){var a=window.getSize();this.playArea={width:a.x-this.options.spriteWidth,height:a.y-this.options.spriteHeight};this.container=$(document.body)},getContainersize:function(c){this.container=document.getElementById(this.options.moduleID);var b;if(c==="module"){b=this.container}if(c==="position"){var a=this.container.getParent();if(a.getProperty("class")!==null&&a.getProperty("class").indexOf("moduletable")!==-1){b=a.getParent()}else{b=a}b.setStyle("position","relative");this.container.setStyles({width:$(b).getStyle("width").toInt(),height:$(b).getStyle("height").toInt(),top:0,left:0,position:"absolute"})}this.playArea={width:$(b).getStyle("width").toInt()-this.options.spriteWidth,height:$(b).getStyle("height").toInt()-this.options.spriteHeight}},animSprites:function(){for(i=0;i<this.options.spritesNum;++i){var c=this.spriteArray[i].getStyles("top","left");var b=c.left.toInt();var a=c.top.toInt();var e;var d;if(Math.abs(this.vSpeed)>Math.abs(this.hSpeed)){e=this.variance[i]>0?b+Math.sin(a/this.variance[i])+this.hSpeed:b+this.hSpeed;d=a+this.vSpeed}else{e=b+this.hSpeed;d=this.variance[i]>0?a+Math.cos(b/this.variance[i])+this.vSpeed:a+this.vSpeed}if(e<=0||e>=this.playArea.width-10||d<=0||d>=this.playArea.height-10){if(this.vSpeed===0){d=Math.random()*this.playArea.height;e=this.hSpeed>0?0:this.playArea.width-15}else{if(this.vSpeed>0){d=0;e=Math.random()*this.playArea.width}else{d=this.playArea.height-50;e=Math.random()*this.playArea.width}}}this.spriteArray[i].setStyles({top:d,left:e})}},resetAnim:function(){for(i=0;i<this.options.spritesNum;++i){this.spriteArray[i].destroy()}this.getWinsize();this.createSprites()}});